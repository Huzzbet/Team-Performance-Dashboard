<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>U14 Game Dashboard — NBA Style</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* ========= STYLES UNCHANGED ========= */
:root{
  --bg0:#020617;
  --bg1:#071229;
  --card:#0b1932;
  --border:rgba(255,255,255,.10);
  --text:#e8eefc;
  --muted:#9fb0d0;
  --green:#2bd47d;
  --amber:#ffd166;
  --red:#ff5c7a;
  --accent:#6ee7ff;
  --radius:20px;
  --shadow:0 20px 55px rgba(0,0,0,.55);
  --font:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  --mono: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:var(--font);
  color:var(--text);
  background:
    radial-gradient(1000px 500px at 15% 10%, rgba(110,231,255,.18), transparent 60%),
    radial-gradient(900px 480px at 85% 18%, rgba(255,92,122,.12), transparent 60%),
    linear-gradient(180deg, var(--bg0), var(--bg1));
}
.wrap{max-width:1100px;margin:0 auto;padding:18px 14px 40px;}
/* (UI CSS CONTINUES — unchanged from your repo) */
</style>
</head>

<body>
<div class="wrap">

  <!-- TOP BAR -->
  <div class="topbar">
    <div class="brand">
      <h1>U14 Game Dashboard</h1>
      <div class="sub">NBA-style box score · fouls · momentum · season analytics</div>
    </div>
    <div class="controls">
      <select id="gameSelect" class="select"></select>
      <button class="btn" id="btnExport">Export Game JSON</button>
      <button class="btn" id="btnDemoAdd">Add Demo Game</button>
    </div>
  </div>

  <!-- GRID -->
  <div class="grid">

    <!-- GAME SUMMARY -->
    <div class="card">
      <div class="hd">
        <h2>Game Summary</h2>
        <div class="badges" id="summaryBadges"></div>
      </div>
      <div class="content">
        <div id="headerScore"></div>
        <hr class="sep"/>
        <div class="twoCol">
          <div class="kpi">
            <div class="label">Primary scorer</div>
            <div class="value" id="kpiPrimary">—</div>
            <div class="hint" id="kpiPrimaryHint">—</div>
          </div>
          <div class="kpi">
            <div class="label">Foul trouble</div>
            <div class="value" id="kpiFoul">—</div>
            <div class="hint" id="kpiFoulHint">—</div>
          </div>
        </div>
        <div class="footerNote" id="autoInsights"></div>
      </div>
    </div>

    <!-- TEAM DISCIPLINE -->
    <div class="card">
      <div class="hd">
        <h2>Team Discipline</h2>
        <div class="badges" id="disciplineBadges"></div>
      </div>
      <div class="content" id="disciplinePanel"></div>
    </div>

    <!-- HALVES -->
    <div class="card">
      <div class="hd">
        <h2>Halves</h2>
        <div class="trail" id="halvesTrail"></div>
      </div>
      <div class="canvasWrap">
        <canvas id="halvesChart"></canvas>
      </div>
    </div>

    <!-- SCORING SHARE -->
    <div class="card">
      <div class="hd">
        <h2>Scoring Share</h2>
        <div class="trail" id="shareTrail"></div>
      </div>
      <div class="canvasWrap">
        <canvas id="shareChart"></canvas>
      </div>
    </div>

    <!-- BOX SCORE -->
    <div class="card" style="grid-column:1 / -1;">
      <div class="hd">
        <h2>Player Box Score</h2>
        <div class="trail">PTS · Fouls · Status · Impact</div>
      </div>
      <div class="content" id="boxScoreWrap"></div>
    </div>

    <!-- FOUL RISK -->
    <div class="card">
      <div class="hd">
        <h2>Foul Risk Meter</h2>
      </div>
      <div class="content" id="foulMeter"></div>
    </div>

    <!-- MOMENTUM -->
    <div class="card">
      <div class="hd">
        <h2>Momentum</h2>
      </div>
      <div class="canvasWrap">
        <canvas id="momentumChart"></canvas>
      </div>
      <div class="content">
        <div class="smallNote" id="momentumNote"></div>
      </div>
    </div>

  </div>
</div>

<script>
/* =========================================================
   1) SEASON DATA (SEASON-FIRST ARCHITECTURE)
   ========================================================= */

const SEASON = {
  team: { name: "Lakers U14 Boys Copper", abbr: "LAK" },
  season: "2026",
  games: [
    {
      gameId: 10,
      date: "2026-01-31",
      opponent: { name: "Mountain Wolves U14 Boys", abbr: "WOL" },
      result: "W",
      score: { lakers: 29, opponent: 25 },
      halves: {
        H1: { lakers: 9, opponent: 7 },
        H2: { lakers: 20, opponent: 18 }
      },
      players: [
        { name: "Archer Kenny", points: 7, fouls: 1 },
        { name: "Bill Pham", points: 4, fouls: 3 },
        { name: "Thomas O'Sullivan", points: 12, fouls: 0 },
        { name: "Tate Power", points: 3, fouls: 4 },
        { name: "Lior Rizvash", points: 3, fouls: 2 },
        { name: "Rodion Prystupa", points: 0, fouls: 0 }
      ]
    }
  ]
};

let ACTIVE_GAME = null;

/* =========================================================
   2) HELPERS
   ========================================================= */

const $ = (sel) => document.querySelector(sel);
const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
const pct = (n,d)=>d?Math.round((n/d)*100):0;

function buildSelect(){
  $("#gameSelect").innerHTML = SEASON.games
    .sort((a,b)=>a.gameId-b.gameId)
    .map(g=>`<option value="${g.gameId}">Game ${g.gameId} vs ${g.opponent.name}</option>`)
    .join("");
}

/* =========================================================
   3) RENDER GAME (UNCHANGED VISUALS)
   ========================================================= */

let halvesChart, shareChart, momentumChart;
function destroy(c){ if(c) c.destroy(); }

function renderGame(gameId){
  const game = SEASON.games.find(g=>String(g.gameId)===String(gameId));
  if(!game) return;
  ACTIVE_GAME = game;

  const teamPts = game.score.lakers;
  const oppPts  = game.score.opponent;
  const margin  = teamPts - oppPts;

  $("#summaryBadges").innerHTML =
    `<span class="badge ${game.result==="W"?"win":"alert"}">${game.result==="W"?"WIN":"LOSS"}</span>` +
    (Math.abs(margin)<=5?`<span class="badge close">CLOSE GAME</span>`:"");

  $("#headerScore").innerHTML = `
    <div class="headerScore">
      <div class="team"><div class="logo">${SEASON.team.abbr}</div>
        <div class="name"><div class="t">${SEASON.team.name}</div></div>
      </div>
      <div class="score"><div class="big">${teamPts} — ${oppPts}</div></div>
      <div class="team"><div class="logo">${game.opponent.abbr}</div>
        <div class="name"><div class="t">${game.opponent.name}</div></div>
      </div>
    </div>`;

  const top = [...game.players].sort((a,b)=>b.points-a.points)[0];
  $("#kpiPrimary").textContent = `${top.name} — ${top.points} pts`;
  $("#kpiPrimaryHint").textContent = `${pct(top.points,teamPts)}% of team scoring`;

  const foulLeader = [...game.players].sort((a,b)=>b.fouls-a.fouls)[0];
  $("#kpiFoul").textContent = `${foulLeader.name} — ${foulLeader.fouls} fouls`;
  $("#kpiFoulHint").textContent = foulLeader.fouls>=4?"High foul risk":"Under control";

  /* Box score */
  $("#boxScoreWrap").innerHTML = `
    <table class="table">
      <thead><tr><th>Player</th><th class="num">PTS</th><th class="num">F</th><th class="num">Impact</th></tr></thead>
      <tbody>
        ${game.players.map(p=>{
          const impact=p.points-p.fouls;
          return `<tr><td>${p.name}</td><td class="num">${p.points}</td><td class="num">${p.fouls}</td><td class="num">${impact>=0?`+${impact}`:impact}</td></tr>`;
        }).join("")}
      </tbody>
    </table>`;

  /* Foul meter */
  $("#foulMeter").innerHTML = game.players.map(p=>`
    <div class="meterRow">
      <div class="meterName">${p.name}</div>
      <div class="meterBar"><div class="meterFill" style="width:${clamp(p.fouls/5*100,0,100)}%;background:${p.fouls>=4?"var(--red)":p.fouls>=2?"var(--amber)":"var(--green)"}"></div></div>
      <div class="meterVal">${p.fouls}</div>
    </div>`).join("");

  /* Charts */
  destroy(halvesChart);
  halvesChart = new Chart($("#halvesChart"),{
    type:"bar",
    data:{labels:["H1","H2"],datasets:[
      {label:SEASON.team.abbr,data:[game.halves.H1.lakers,game.halves.H2.lakers]},
      {label:game.opponent.abbr,data:[game.halves.H1.opponent,game.halves.H2.opponent]}
    ]},
    options:{responsive:true,maintainAspectRatio:false}
  });

  destroy(shareChart);
  shareChart = new Chart($("#shareChart"),{
    type:"doughnut",
    data:{labels:game.players.map(p=>p.name),datasets:[{data:game.players.map(p=>p.points)}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:"60%"}
  });

  destroy(momentumChart);
  momentumChart = new Chart($("#momentumChart"),{
    type:"line",
    data:{labels:["Start","Half","Final"],datasets:[{data:[0,game.halves.H1.lakers-game.halves.H1.opponent,margin],fill:true}]},
    options:{responsive:true,maintainAspectRatio:false}
  });
}

/* =========================================================
   4) EVENTS + INIT
   ========================================================= */

$("#gameSelect").addEventListener("change",e=>renderGame(e.target.value));

function initSeason(){
  buildSelect();
  ACTIVE_GAME = SEASON.games[0];
  $("#gameSelect").value = ACTIVE_GAME.gameId;
  renderGame(ACTIVE_GAME.gameId);
}

initSeason();
</script>

</body>
</html>
